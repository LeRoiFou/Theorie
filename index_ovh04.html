<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OVH - Chapitre IV</title>
    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <h1>Chapitre IV : Approfondissement</h1>
    <br>

    <ul>
        <li id="prio">Site web sÃ©curisÃ© avec HTTPS</li>
        <li>Nom de domaine Ã  la place d'une adresse IP</li>
        <li>AccÃ¨s limite au site par adresse IP</li>
        <li>OVHcloud SecNumCloud ?</li>
    </ul>
    <hr>

    <h2>1. Mise Ã  jour de l'application</h2>

    <ul>
        <li>Modifier le script python</li><br>

        <li>DockÃ©riser Ã  nouveau le script via <i>docker build --no-cache -t nomImage .</i> </li><br>

        <li> Exporter lâ€™image en dossier archivÃ© .tar sur le PC, en saisissant dans le shell en local ğŸ‘‰
            <strong>docker save REPOSITORY:TAG -o REPOSITORY.tar</strong> avec :
            <ul>
                <li>"REPOSITORY" â†’ nom du repository de l'image Ã  importer sur la VM</li>
                <li>"TAG" â†’ nom du TAG de l'image Ã  importer sur la VM</li>
            </ul><br>
        </li>
        <li>VÃ©rifier que le dossier archivÃ© .tar a bien Ã©tÃ© crÃ©Ã© en local en saisissant dans le shell en local
            ğŸ‘‰
            <strong>ls cloudprojet003.tar</strong>
        </li><br>

        <li>Sur le site OVH, aprÃ¨s avoir sÃ©lectionnÃ© le projet, aller sur le menu Ã  gauche â†’ partie "COMPUTE" â†’
            sous-partie "Instances" (le statut doit Ãªtre en mode "activÃ©")</li><br>

        <li>Ouvrir Windows PowerShell et saisir ceci pour se connecter dans la VM : <br>
            <strong> ssh -i $env:USERPROFILE\.ssh\id_ed25519 ubuntu@IPv4</strong>
        </li><br>

        <li>Copier le dossier archivÃ© .tar vers la VM OVH en saissisant dans le shell en local ğŸ‘‰
            <strong>scp -i $env:USERPROFILE\.ssh\id_ed25519 REPOSITORY.tar
                ubuntu@IPv4:/home/ubuntu/</strong>
        </li><br>

        <li>Charger l'image dans Docker sur la VM, en saissisant dans le terminal de la VM ğŸ‘‰
            <strong>docker load -i REPOSITORY.tar</strong>
        </li><br>

        <li>VÃ©rifier que l'image dans Docker a bien Ã©tÃ© chargÃ©e sur la VM en saisissant dans le shell de
            la VM ğŸ‘‰ <strong>docker images</strong></li><br>

        <li>Supprimer le conteneur arrÃªtÃ© en saisissant dans le shell de la VM ğŸ‘‰ <strong>docker rm -f
                REPOSITORY-container</strong> (-f : <i>force l'arrÃªt notamment si le conteneur
                est en cours d'exÃ©cution</i>
            )<br>
        </li><br>

        <li>Relancer le conteneur en saissant dans le shell de la VM ğŸ‘‰ <strong>docker run -d --restart
                unless-stopped --name REPOSITORY-container -p
                PortReseau:PortReseau
                REPOSITORY:TAG</strong>
        </li><br>
        <li>VÃ©rifier que le conteneur a bien Ã©tÃ© relancÃ© en saissisant dans le shell de la VM ğŸ‘‰
            <strong>docker ps</strong>
    </ul>

    <p><strong><i>NB : on copie le nouveau conteneur modifiÃ© sur la VM <u>AVANT</u> de supprimer le prÃ©cÃ©dent conteneur
                afin d'Ã©viter tout risque de panne, et notamment que le prÃ©cÃ©dent conteneur continue toujours de
                s'exÃ©cuter si le conteneur modifiÃ© ne s'installe pas correctement dans la VM</i></strong></p><br>


    <h2>2. Site web sÃ©curisÃ© avec HTTPS</h2>

    <br><br>
    <a id='lien' href="./index.html">Retour au sommaire</a>
</body>

</html>