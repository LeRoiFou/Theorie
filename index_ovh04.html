<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OVH - Chapitre IV</title>
    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <h1>Chapitre IV : Approfondissement</h1>
    <br>

    <hr>

    <ul>
        <li id="prio">Site web sÃ©curisÃ© avec HTTPS</li>
        <li>Nom de domaine Ã  la place d'une adresse IP</li>
        <li>AccÃ¨s limite au site par adresse IP</li>
        <li>OVHcloud SecNumCloud ?</li>
    </ul>

    <!-- *************** Menu ********************* -->
    <hr>
    <div>
        <p><u><strong>Menu :</strong></u></p>
        <ol id="menu" type="1">
            <li><a href="#chap1">Mise Ã  jour de l'application</a></li>
            <li><a href="#chap2">Site web sÃ©curisÃ© avec HTTPS</a></li>
            <li></li>
        </ol>
    </div>
    <hr>

    <!-- Chapitre I -->
    <h2 id="chap1">1. Mise Ã  jour de l'application</h2>

    <ul>
        <li>Modifier le script python</li><br>

        <li>DockÃ©riser Ã  nouveau le script via <i>docker build --no-cache -t nomImage .</i> </li><br>

        <li> Exporter lâ€™image en dossier archivÃ© .tar sur le PC, en saisissant <u>dans le shell en local</u> ğŸ‘‰
            <strong>docker save REPOSITORY:TAG -o REPOSITORY.tar</strong> avec :
            <ul>
                <li>"REPOSITORY" â†’ nom du repository de l'image Ã  importer sur la VM</li>
                <li>"TAG" â†’ nom du TAG de l'image Ã  importer sur la VM</li>
            </ul><br>
        </li>
        <li>VÃ©rifier que le dossier archivÃ© .tar a bien Ã©tÃ© crÃ©Ã© en local en saisissant <u>dans le shell en local</u>
            ğŸ‘‰ <strong>ls REPOSITORY.tar</strong>
        </li><br>

        <li>Sur le site OVH, aprÃ¨s avoir sÃ©lectionnÃ© le projet, aller sur le menu Ã  gauche â†’ partie "COMPUTE" â†’
            sous-partie "Instances" (le statut doit Ãªtre en mode "activÃ©")</li><br>

        <li>Copier le dossier archivÃ© .tar vers la VM OVH en saissisant <u>dans le shell en local</u> ğŸ‘‰
            <strong>scp -i $env:USERPROFILE\.ssh\id_ed25519 REPOSITORY.tar
                ubuntu@IPv4:/home/ubuntu/</strong>
        </li><br>

        <li>Saisir ceci pour se connecter dans la VM : <br>
            <strong> ssh -i $env:USERPROFILE\.ssh\id_ed25519 ubuntu@IPv4</strong>
        </li><br>

        <li>Charger l'image dans Docker sur la VM, en saissisant <u>dans le shell de la VM</u> ğŸ‘‰
            <strong>docker load -i REPOSITORY.tar</strong>
        </li><br>

        <li>VÃ©rifier que l'image dans Docker a bien Ã©tÃ© chargÃ©e sur la VM en saisissant <u>dans le shell de la VM</u> ğŸ‘‰
            <strong>docker images</strong>
        </li><br>

        <li>Supprimer le conteneur arrÃªtÃ© en saisissant <u>dans le shell de la VM</u> ğŸ‘‰ <strong>docker rm -f
                REPOSITORY-container</strong> (-f : <i>force l'arrÃªt notamment si le conteneur
                est en cours d'exÃ©cution</i>
            ).<br><br>
            âš ï¸ <i>Si l'ancien conteneur est toujours prÃ©sent dans la VM malgrÃ© l'instruction saisie ci-avant, ce
                conteneur
                est une image orpheline qu'il faut supprimer
                en saissant <u>dans le shell de la VM</u> ğŸ‘‰</i> <strong>docker image prune -f </strong>
        </li><br>

        <li>Lancer l'application en saissant <u>dans le shell de la VM</u> ğŸ‘‰ <strong>docker run -d --restart
                unless-stopped --name REPOSITORY-container -p
                PortReseau:PortReseau
                REPOSITORY:TAG</strong>
        </li><br>
        <li>VÃ©rifier que l'application a bien Ã©tÃ© relancÃ©e en saissisant <u>dans le shell de la VM</u> ğŸ‘‰
            <strong>docker ps</strong>
    </ul>

    <p><strong><i>NB : on copie le nouveau conteneur modifiÃ© sur la VM <u>AVANT</u> de supprimer le prÃ©cÃ©dent conteneur
                afin d'Ã©viter tout risque de panne, et notamment que le prÃ©cÃ©dent conteneur continue toujours de
                s'exÃ©cuter si le conteneur modifiÃ© ne s'installe pas correctement dans la VM</i></strong></p>

    <i><a href="#menu">Retour au menu</a></i><br><br>

    <!-- Chapitre II -->
    <h2 id="chap2">2. Site web sÃ©curisÃ© avec HTTPS</h2>



    <i><a href="#menu">Retour au menu</a></i><br><br>

    <a id='lien' href="./index.html">Retour au sommaire</a>
</body>

</html>